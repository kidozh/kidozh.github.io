<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> [Python]自动填教学评估 · kidozh</title><meta name="description" content="[Python]自动填教学评估 - kido zhang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://kidozh.com/atom.xml" title="kidozh"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/u/1793490853" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/kidozh" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">[Python]自动填教学评估</h1><div class="post-info">2015年5月19日</div><div class="post-content"><p><span style="font-family: Microsoft YaHei UI; font-size: 14pt;"> 鉴于学校现在可（e）爱（xin）的网上评估体系，一个一个填老师的教学评估是在是一种煎熬，那么这时候Python的爬虫就可以派上用场了！<br> </span></p>
<p><span style="font-family: Microsoft YaHei UI; font-size: 14pt;">Ps：学校居然把学生的账号密码明文传输，简直就是SXBK<br> </span></p>
<p><span style="font-family: Microsoft YaHei UI; font-size: 14pt;">原理还是基于Urllib的爬虫和模拟登陆和发送POST请求的原理，你可以百度一下？<br> </span></p>
<p><span style="font-family: Microsoft YaHei UI; font-size: 14pt;">首先，你应该登陆学校的教务系统（不是翱翔门户啊亲！）like this：好吧 那个逗比的张纪铎不是我<img src="/wp-content/uploads/2015/05/051915_0658_Python1.png" alt=""><br> </span></p>
<p><span style="font-family: Microsoft YaHei UI; font-size: 14pt;">然后你可以复制到脚本上面就可以了，下面就是脚本信息了<br> </span></p>
<pre class="lang:python decode:true ">__author__ = "kido"
# coding=gbk
import urllib2
import cookielib
import re
import thread
import time
import threading
import urllib

def detect_home(website):

 req = urllib2.Request(
 url = website,
 headers = headers
 )
 result = opener.open(req)
 html =result.read()
 #print html.decode("gb2312")

def detect_teacher():
 postData = {
 "callCount":"1",
 "pageSize":"300"
 }
 req = urllib2.Request(
 url = "http://222.24.192.69/jxpgXsAction.do?oper=listWj&amp;totalrows=11&amp;pageSize=300",
 headers = headers,
 )
 result = opener.open(req)
 html =result.read().decode("gb2312")
 #print html
 sem = re.findall(r"&lt;img name="([0-9]*?)#@([0-9]*?)#@(.*?)#@(.*?)#@(.*?)#@(.*?)" style="cursor: hand;" title=".*?"",html,re.S)
 for i in sem :
 #print [online casino](http://www.svenskkasinon.com/)  i[0],i[1],i[2],i[3],i[4],i[5]
 print "# You are evaluate ",i[2],"Class : ",i[4]
 detect_detail(i[0],i[1],i[5])

def detect_detail(wjbm,bpr,pgnr):# this will send postdata !
 postData = {
 "wjbm":wjbm,
 "bpr":bpr,
 "pgnr":pgnr,
 "oper":"wjShow",
 "page":"1",
 "pageSize":"300",
 "currentPage":"1"
 }
 postData = urllib.urlencode(postData)
 req = urllib2.Request(
 url = "http://222.24.192.69/jxpgXsAction.do",
 data = postData,
 headers = headers
 )

 result = opener.open(req)
 #print result.read().decode("gb2312")# get linked with table!

 #----------------------------------------#
 postData = {
 "wjbm":wjbm,
 "bpr":bpr,
 "pgnr":pgnr,
 "0000000093":"10_1",
 "0000000094":"10_1",
 "0000000095":"10_1",
 "0000000096":"10_1",
 "0000000097":"10_1",
 "0000000098":"10_1",
 "0000000099":"10_1",
 "0000000100":"10_1",
 "0000000101":"10_1",
 "0000000102":"10_1",
 "zgpj":"very good"
 }
 postData = urllib.urlencode(postData)
 req = urllib2.Request(
 url = "http://222.24.192.69/jxpgXsAction.do?oper=wjpg",
 data = postData,
 headers = headers
 )
 result = opener.open(req)
 #print result.read().decode("gb2312")# get linked with table!

#----------------------main function-------------------
headers = {
 "User-Agent":"Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6",
}
cookie = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))
while 1:
 formattime = time.strftime("%Y-%m-%d %H:%M:%S",time.localtime(time.time()))
 try:
 print "-------------------------------"
 print " Author : kidozh "
 print " supported University : Northwestern Polytechnical University "
 print " Current time : " formattime
 print " language : Python"
 print " Shit CAS "
 print "--------------------------------"
 except :
 print "Cannot show welcome page..." formattime
 name = raw_input("please input your CAS Address : (eg. http://222.24.192.69/loginAction.do?dlfs=mh&amp;mh_zjh=2013300116&amp;mh_mm=XXXXXX)\n")
 detect_home(name)
 detect_teacher()

</pre>

</div></article></div></main><footer><div class="paginator"><a href="/2015/05/30/ros-e7-a7-91-e6-8a-80-e6-a0-91-e4-b9-b1-e7-82-b9-e4-b8-ad/" class="prev">上一篇</a><a href="/2015/05/05/e5-ae-89-e5-85-a8-e5-b7-a5-e7-a8-8b-e5-bc-80-e5-9d-91-e7-af-87/" class="next">下一篇</a></div><div class="copyright"><p>© 2013 - 2017 <a href="http://kidozh.com">kido zhang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>